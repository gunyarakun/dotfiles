#!/bin/sh
# vim: set expandtab ts=2 sw=2 nowrap ft=sh ff=unix : */
set -e -u

cwd=$(dirname $0)
base_dir=$(cd $cwd; pwd)
uname=`uname`;

# update submodules
git submodule init
git submodule update

# bin
if [ ! -d ~/bin ]; then
  mkdir ~/bin
  for path in `ls -1 bin/*`
  do
    ln -snf $base_dir/$path ~/$path
  done
fi

# zsh
if [ ! -d ~/.zsh ]; then
  mkdir ~/.zsh
  ln -snf $base_dir/zsh ~/.zsh/zsh
  git clone https://github.com/zsh-users/antigen.git ~/.zsh/antigen
  cat <<EOF >> ~/.zshrc
source ~/.zsh/zsh/zshrc.index
EOF
fi

if which go; then
  # peco
  if [ ! -d ~/.peco ]; then
    go get github.com/lestrrat/peco/cmd/peco
    ln -snf $base_dir/peco ~/.peco
  fi

  # ghq
  if [ ! -d ~/.ghq ]; then
    go get github.com/motemen/ghq
  fi
fi

# git
ln -snf $base_dir/git/gitconfig ~/.gitconfig

# vim
ln -snf $base_dir/vim/vimrc ~/.vimrc
ln -snf $base_dir/vim/vim ~/.vim
vim +NeoBundleInstall +qall
